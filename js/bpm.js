var _0xfbba=["getTime","push","length","shift","round","html","#bpm_display","#score_display","Calc","max","min","abs","pow","BPM","Score","flow","#myChart","y","y2","#5cb85c","#5bc0de","Beats","outer-center","outer-middle","generate"];avg_beats=4;plot_len=150;time_diff_limit=1000;time_diffs=[];time_prev=0;time_first=0;graph_len=0;bpm_avg=0;var chart;construct_graph();function get_beat(){var _0xec9dx3=( new Date)[_0xfbba[0]]();time_diffs[_0xfbba[1]](_0xec9dx3-time_prev);if(time_diffs[_0xfbba[2]]>time_diff_limit){time_diffs[_0xfbba[3]]()};if(too_long(_0xec9dx3-time_prev)){return reset(_0xec9dx3)};if(time_diffs[_0xfbba[2]]>=avg_beats){var _0xec9dx4=0;for(var _0xec9dx5=1;_0xec9dx5<=avg_beats;_0xec9dx5++){_0xec9dx4+=time_diffs[time_diffs[_0xfbba[2]]-_0xec9dx5]};bpm_avg=60000*avg_beats/_0xec9dx4;}else {bpm_avg=60000/time_diffs[time_diffs[_0xfbba[2]]-1]};var _0xec9dx6=compute_score();$(_0xfbba[6])[_0xfbba[5]](Math[_0xfbba[4]](bpm_avg));$(_0xfbba[7])[_0xfbba[5]](Math[_0xfbba[4]](_0xec9dx6));update_graph(Math[_0xfbba[4]](bpm_avg),Math[_0xfbba[4]](_0xec9dx6),(_0xec9dx3-time_first)/1000);time_prev=_0xec9dx3;return _0xec9dx3;}function reset(_0xec9dx3){time_prev=_0xec9dx3;time_first=_0xec9dx3;time_diffs=[];$(_0xfbba[6])[_0xfbba[5]](_0xfbba[8]);$(_0xfbba[7])[_0xfbba[5]](_0xfbba[8]);graph_len=0;construct_graph();}function too_long(_0xec9dx9){if(bpm_avg==0){return _0xec9dx9>5000};reset_beats=4;reset_time=Math[_0xfbba[10]](5000,Math[_0xfbba[9]](2000,(60000*reset_beats)/bpm_avg));return _0xec9dx9>reset_time;}function compute_score(){if(time_diffs[_0xfbba[2]]==1){return 0};var _0xec9dxb=0;for(var _0xec9dx5=0;_0xec9dx5<time_diffs[_0xfbba[2]];_0xec9dx5++){_0xec9dxb+=time_diffs[_0xec9dx5]};var _0xec9dxc=_0xec9dxb/time_diffs[_0xfbba[2]];_0xec9dxb=0;for(var _0xec9dx5=0;_0xec9dx5<time_diffs[_0xfbba[2]];_0xec9dx5++){_0xec9dxb+=100*Math[_0xfbba[12]](Math[_0xfbba[11]](time_diffs[_0xec9dx5]-_0xec9dxc),0.8)};var _0xec9dxd=_0xec9dxb/time_diffs[_0xfbba[2]];var _0xec9dxe=1600;var _0xec9dxf=800;return Math[_0xfbba[10]](1000,Math[_0xfbba[9]](1000-1000/_0xec9dxe*(_0xec9dxd-_0xec9dxf),0));}function update_graph(_0xec9dx11,_0xec9dx6,_0xec9dx3){if(graph_len>=plot_len-1){chart[_0xfbba[15]]({columns:[[_0xfbba[13],_0xec9dx11],[_0xfbba[14],_0xec9dx6]]})}else {chart[_0xfbba[15]]({columns:[[_0xfbba[13],_0xec9dx11],[_0xfbba[14],_0xec9dx6]],length:0});graph_len++;}}function construct_graph(){chart=c3[_0xfbba[24]]({bindto:_0xfbba[16],size:{height:600},data:{columns:[[_0xfbba[13]],[_0xfbba[14]]],axes:{BPM:_0xfbba[17],Score:_0xfbba[18]},colors:{BPM:_0xfbba[19],Score:_0xfbba[20]}},axis:{x:{label:{text:_0xfbba[21],position:_0xfbba[22]}},y:{padding:{bottom:3},label:{text:_0xfbba[13],position:_0xfbba[23]}},y2:{show:true,padding:{bottom:3},label:{text:_0xfbba[14],position:_0xfbba[23]},min:0,max:1000}},grid:{x:{show:true},y:{show:true}},legend:{show:false},point:{show:false},transition:{duration:100}})}